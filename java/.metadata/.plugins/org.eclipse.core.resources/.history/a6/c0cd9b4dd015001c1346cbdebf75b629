package book;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import utility.DBClose;
import utility.Open;

public class BookTest {
	
	public static void main(String[] args) {
//		BookDTO dto = new BookDTO(21424, "Java Basic", "김하나", "Jaen.kr", 15000, "Java 기본 문법");
//		BookDTO dto2 = new BookDTO(33455, "JDBC Pro", "김철수", "Jaen.kr", 23000);
//		BookDTO dto3 = new BookDTO(55355, "Servlet/JSP", "박자바", "Jaen.kr", 41000, "Model2 기반");
//		BookDTO dto4 = new BookDTO(35332, "Android App", "홍길동", "Jaen.kr", 25000, "Lightweight Framework");
//		BookDTO dto5 = new BookDTO(35355, "OOAD 분석, 설계", "소나무", "Jaen.kr", 30000);
//		p("*********************** 도서 목록 ***********************");
//		p(dto.toString());
//		p(dto2.toString());
//		p(dto3.toString());
//		p(dto4.toString());
//		p(dto5.toString());
		
		
	}
	
	private static void p(String s) {
		System.out.println(s);
	}
	
//	public BookDTO(int isbn, String title, String author, String publisher, int price, String info) {
//		super();
//		this.isbn = isbn;
//		this.title = title;
//		this.author = author;
//		this.publisher = publisher;
//		this.price = price;
//		this.info = info;
//	}
	
	public void insertStudent(BookDTO book) {
		Connection con = Open.getConnection();
		PreparedStatement prst = null;
		StringBuffer sql = new StringBuffer();
		
		sql.append("INSERT INTO books (isbn, title, author, publisher, price, info) ");
		sql.append("values(?,?,?,?,?,?)");
		try {
			prst = con.prepareStatement(sql.toString());
			prst.setInt(1, book.getIsbn());
			prst.setString(2, book.getTitle());
			prst.setString(3, book.getAuthor());
			prst.setString(4, book.getPublisher());
			prst.setInt(5, book.getPrice());
			prst.setString(6, book.getInfo());
			
			int cnt = prst.executeUpdate();
			
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			DBClose.close(prst, con);
		}
	}
	
	public void printAllBooks() {
		
	}
	
	public List<BookDTO> list(){
		List<BookDTO> list = new ArrayList<>();
		Connection con = Open.getConnection();
		PreparedStatement prst = null;
		StringBuffer sql = new StringBuffer();
		ResultSet rs = null;
		
		sql.append("select * ");
		sql.append("from address order by name desc");
		try {
			prst = con.prepareStatement(sql.toString());
			rs = prst.executeQuery();
			while(rs.next()) {
				AddressDTO dto = new AddressDTO();
				dto.setAddressnum(rs.getInt("addressnum"));
				dto.setName(rs.getString("name"));
				dto.setHandphone(rs.getString("handphone"));
				dto.setAddress(rs.getString("address"));
				
				list.add(dto);
			}
		} catch (SQLException e) {
			e.printStackTrace();
		}finally {
			DBClose.close(prst, con,rs);
		}
		
		return list;
	}
}
